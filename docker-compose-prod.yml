version: "3"
services:
  server:
    image: ttp-back:latest
    container_name: ttp_back
    build:
      context: ./BE/Talktopia/talktopia
      args:
        SERVER_MODE: prod
    ports:
        - 10001:8000
    environment:
        - TZ=Asia/Seoul
    networks:
      - talktopia_network
  client:
    image: ttp-front:latest
    container_name: ttp_front
    build:
      context: ./FE/talktopia
      dockerfile: Dockerfile
    ports:
      - 3000:3000
    depends_on:
      - server
    networks:
        - talktopia_network
  nginx:
    image: ttp-nginx:latest
    container_name: ttp_nginx
    build: ./.nginx
#    depends_on:
#      - server
    ports:
      - 80:80
      - 443:443
    networks:
      - talktopia_network
networks:
  talktopia_network:
    driver: bridge
